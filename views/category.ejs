<%- include('layout', { body: `
<div class="max-w-5xl mx-auto">

  <!-- Page Header -->
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-slate-900">ðŸ“‚ Categories</h1>

    <% if (currentUser && (currentUser.role === 'moderator' || currentUser.role === 'admin')) { %>
      <button 
        onclick="document.getElementById('addCat').classList.toggle('hidden')" 
        class="px-4 py-2 bg-accent-1 text-white rounded shadow hover:opacity-90">
        âž• Add Category
      </button>
    <% } %>
  </div>

  <!-- Add Category Form (Moderator/Admin only) -->
  <% if (currentUser && (currentUser.role === 'moderator' || currentUser.role === 'admin')) { %>
    <div id="addCat" class="hidden mb-6 bg-white rounded-xl shadow p-6">
      <h2 class="text-xl font-semibold mb-3">Create New Category</h2>

      <form action="/categories" method="POST" class="space-y-4">
        <input 
          name="name" required 
          placeholder="Category Name" 
          class="w-full p-3 border rounded" />

        <input 
          name="description" required 
          placeholder="Short Description" 
          class="w-full p-3 border rounded" />

        <button 
          class="px-4 py-2 bg-accent-3 text-white rounded shadow hover:opacity-90">
          Create Category
        </button>
      </form>
    </div>
  <% } %>

  <!-- Category List -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6" data-aos="fade-up">
    <% if (categories && categories.length > 0) { %>
      <% categories.forEach(cat => { %>
        <div class="bg-white p-5 rounded-lg shadow hover:shadow-md transition">

          <a href="/categories/<%= cat._id %>" class="text-xl font-bold text-accent-1 hover:underline">
            <%= cat.name %>
          </a>

          <p class="text-slate-600 mt-1">
            <%= cat.description %>
          </p>

          <div class="flex justify-between items-center mt-4">
            <span class="text-sm text-slate-500">
              Threads: <strong><%= cat.count || 0 %></strong>
            </span>

            <% if (currentUser && (currentUser.role === "moderator" || currentUser.role === "admin")) { %>
              <form action="/categories/<%= cat._id %>/delete" method="POST">
                <button 
                  onclick="return confirm('Are you sure? All threads inside will be deleted.')"
                  class="px-3 py-1 bg-red-500 text-white rounded text-xs shadow hover:bg-red-600">
                  ðŸ—‘ Delete
                </button>
              </form>
            <% } %>
          </div>
        </div>
      <% }) %>
    <% } else { %>
      <p class="text-slate-500">No categories created yet.</p>
    <% } %>
  </div>

</div>
` }) %>
